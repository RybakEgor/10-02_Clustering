# Домашнее задание к занятию 10.2 «Кластеризация» - `Рыбак Егор`




---

### Задание 1

В чём различие между SMP- и MPP-системами?

*Приведите ответ в свободной форме.*

### Ответ:
- SMP (symmetric multiprocessing) – симметричная многопроцессорная архитектура. Главной особенностью систем с архитектурой SMP является наличие общей физической памяти, разделяемой всеми процессорами. Основная функция сервера SMP - совместное использование, и все ресурсы (процессор, память, ввод-вывод и т. Д.) В системе являются общими. Операционная система управляет очередью, и каждый процессор обрабатывается по очередно. Если два процессора запрашивают доступ к ресурсу одновременно, аппаратный и программный механизм блокировки решает проблему конфликта ресурсов. Также из-за этой функции главная проблема сервера SMP заключается в том, что его возможности расширения очень ограничены. Способы расширения SMP-сервера включают в себя увеличение памяти, использование более быстрого ЦП, увеличение ЦП, расширение операций ввода-вывода (количество слотов и шин) и добавление дополнительных внешних устройств - т.е. поддерживает всё линейное расширение.
- MPP (massive parallel processing) – массивно-параллельная архитектура. Главная особенность такой архитектуры состоит в том, что память физически разделена. MPP образован несколькими серверами SMP (каждый сервер SMP называется узлом), соединенными сетью межузловых соединений.Каждый узел имеет доступ только к своим собственным локальным ресурсам (память, хранилище и т. д.), Что является своего рода полным отсутствием совместного использования. Главным преимуществом систем с раздельной памятью является хорошая масштабируемость: в отличие от SMP-систем, в машинах с раздельной памятью каждый процессор имеет доступ только к своей локальной памяти, в связи с чем не возникает необходимости в потактовой синхронизации процессоров.

---

### Задание 2

В чём отличие сильно связанных и слабо связанных систем?

*Приведите ответ в свободной форме.*

### Ответ:

| **Основа для сравнения**  | **Слабосвязанная многопроцессорная система** | **Сильно связанная многопроцессорная система** |
|:-------------:            |:---------------:                             |:-------------:                                 |
| Базовый                   | У каждого процессора свой модуль памяти      | У процессоров есть общие модули памяти         |
| Эффективность             | Эффективен при выполнении задач на разных процессорах, имеет минимальное взаимодействие       | Эффективен для высокоскоростной обработки или обработки в реальном времени       |
| Конфликт памяти           | Как правило, не сталкиваются с конфликтом памяти     | Испытывает больше конфликтов памяти       |
| Взаимосвязи               | Система передачи сообщений (МТС) | Взаимосвязанные сети PMIN, IOPIN, ISIN       |
| Скорость передачи данных  | Низкая   | Высокая      |
| Стоимость                 | Дешевле | Дороже      |
---

### Задание 3

Какие преимущества отличают кластерные системы от обычных серверов?

*Приведите ответ в свободной форме.*

### Ответ:

Кластерные вычислительные системы:
- формируют единый вычислительный ресурс
- создают иллюзию наличия единственной вычислительной машины.
Каждый узел способен работать автономно. Узел может быть SMP, MPP или однопроцессорной ВМ.

#### Преимущества кластерных систем
- абсолютная масштабируемость
- нет ограничений на размер узлов и кластеров
- наращиваемая масштабируемость
- можно расширять узлы по необходимости
- высокий коэффициент готовности
- отказоустойчивость, благодаря автономности узлов
- соотношение цена/производительность
- можно строить кластер из любых строительных блоков: чем проще и стандартнее блоки, тем дешевле обходится вычислительная мощность.
---

### Задание 4

Приведите примеры типов современных кластерных систем.

*Приведите ответ в свободной форме.*

### Ответ:

Типы современных кластерных систем:
- отказоустойчивые кластеры (High-availability clusters, HA, кластеры высокой доступности) - *Corosync, Red Hat Cluster Suite, Microsoft Windows Server, Linux — HA, Pacemaker*
- кластеры с балансировкой нагрузки (Load balancing clusters) - *VRRP (Virtual Router Redundancy Protocol) + LVS (Linux Virtual Server)*:
  1. Сетевая балансировка - нужно сделать так, чтобы за один конкретный IP-адрес сервера отвечали разные физические машины
  2. транспортная балансировка - клиент обращается к балансировщику, тот перенаправляет запрос одному из серверов, который и будет его обрабатывать - *HAProxy*
  3. прикладная балансировка - балансировщик работает в режиме «умного прокси». Он анализирует клиентские запросы и перенаправляет их на разные серверы в зависимости от характера запрашиваемого контента. Так работает, например, веб-сервер *Nginx*, распределяя запросы между фронтендом и бэкендом
- вычислительные кластеры (High performance computing clusters, HPC) представляет из себя массив серверов (вычислительных узлов или так называемых нодов), объединенных коммуникационной сетью и размещенных в отдельной стойке - *Frontier, Фугаку, Червоненкис*. 
- системы распределенных вычислений - grid-системы - «виртуальный суперкомпьютер» представлен в виде кластеров, соединенных с помощью сети, слабосвязанных гетерогенных компьютеров, работающих вместе для выполнения огромного количества заданий - *zookeper, kafka*

---

### Задание 5

Где используют сервис Kafka, rabitMQ?

*Приведите ответ в свободной форме.*

### Ответ:

Оба сервиса являются брокерами сообщений. 
Брокер сообщений — это программная система полностью или частично реализующая паттерны Pub-Sub и Point-to-Point. Взаимодействие программ через брокер упрощает процесс разработки. Нет необходимости в каждом сервисе реализовывать механизмы доставки, маршрутизации, хранения сообщений — всем этим занимается «посредник». Общение через «посредника» помогает навести порядок и внести ясность в потоки данных, а значит, упростить разработку и снизить вероятность появление ошибок. 
Использование брокера оправдано, если:
- существуют задачи, выполнение которых требует много времени и ресурсов
- не нужен немедленный результат
- необходима координация работы большого количества сервисов (событийная модель общения)
- требуется повысить масштабируемость и отказоустойчивость системы.

1. **RabbitMQ** передаёт сообщения между поставщиками и подписчиками через очереди. Сообщения могут содержать любую информацию, например, о событии, произошедшем на сайте. RabbitMQ отлично подходит для интеграции разных компонентов, создания микросервисов, потоковой передачи данных в режиме реального времени или при передаче работы удалённым работникам. Его используют крупные компании, в числе которых Bloomberg, Reddit, WeWork, NASA и др.
2. **Apache Kafka** — это централизованный сбор, обработка, безопасное хранение и передача большого количества сообщений от отделенных друг от друга сервисов. Эта распределенная, горизонтально масштабируемая платформа обычно применяется там, где очень много больших неструктурированных данных:
   - Масштабные IoT/IIoT-системы, характеризующиеся архитектурой с множеством датчиков, сенсоров, контроллеров и других конечных устройств
   - Системы аналитики. Например, Kafka используется в компаниях IBM и DataSift в качестве коллектора для мониторинга событий и трекера потребления потоков данных пользователями в режиме реального времени.
   - Финансовые системы. Используют финансовые организации: Сбербанк, Тинькофф, Альфа-Банк, ING Bank.
   - Социальные сети. В Twitter Kafka — часть инфраструктуры потоковой обработки, а в LinkedIn используется для потоковой передачи данных о деятельности и операционных показателях приложений
   - Системы геопозиционирования. Foursquare — для передачи сообщений между онлайн- и офлайн-системами, а также для интеграции средств мониторинга в свою big data инфраструктуру на базе Hadoop.
   - Телеком-операторы. ВымпелКом, МТС, Ростелеком и др.
   - Онлайн-игры. Например, Demonware, подразделение Activision Blizzard — для обработки логов пользователей.
#### Сравнение 
Обе системы используются для обмена информацией между приложениями, работают по схеме «издатель — подписчик» и обеспечивают репликацию сообщений. Однако они реализуют принципиально разные модели доставки сообщений: Kafka — pull (получатели сами достают из топика сообщения), а RabbitMQ — push (отправляет сообщения получателям).

Также RabbitMQ удаляет сообщение после доставки, а Kafka хранит его до запланированной очистки журнала. Таким образом, Apache Kafka сохраняет текущее и все прежние состояния системы и может использоваться как достоверный источник исторических данных. Это позволяет множеству потребителей читать одни и те же данные независимо, и такой паттерн удобен, например, в event-driven-системах.

У RabbitMQ очень гибкое управление очередями сообщений (маршрутизация, шаблоны доставки, мониторинг получения), но при большой нагрузке это приводит к снижению производительности. Поэтому для сбора и агрегации событий из множества источников, метрик и логов лучше использовать Apache Kafka, а RabbitMQ подходит для быстрого обмена сообщениями между несколькими сервисами.

---

## Задания со звёздочкой*
Эти задания дополнительные. Их можно не выполнять. На зачёт это не повлияет. Вы можете их выполнить, если хотите глубже разобраться в материале.

---

### Задание 6*

Исследуйте построение кластера на основе rabbitMQ: https://github.com/ypereirareis/docker-rabbitmq-ha-cluster. 
Используя docker-compose, соберите инфраструктуру. Исследуйте её работы.

Ответьте на вопросы.

- На каких компонетах развёрнут кластер?
- Назначение компонентов кластера.
- Какие тесты можно провести для анализа работы кластера?

*Приведите в пример скриншоты работающей системы и ответы на вопросы.*

